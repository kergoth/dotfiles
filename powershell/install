if [ "$OSTYPE" = WSL ] && [ -n "$USERPROFILE" ]; then
    modulesdir="$USERPROFILE/Documents/PowerShell/Modules"
    profiledir="$USERPROFILE/Documents/PowerShell"
else
    modulesdir="$XDG_DATA_HOME/powershell/Modules"
    profiledir="$XDG_CONFIG_HOME/powershell"
fi
link profile.ps1 "$profiledir/Microsoft.PowerShell_profile.ps1"
link profile.ps1 "$profiledir/Microsoft.VSCode_profile.ps1"

if ! [ -e "$modulesdir/DirColors" ]; then
    tmpdir=$(mktemp -d -t "${0##*/}.XXXX")
    trap 'rm -rf "$tmpdir"' EXIT INT TERM
    git clone -b v1.1.2 https://github.com/DHowett/DirColors "$tmpdir/git"
    mkdir -p "$modulesdir/DirColors"
    mv "$tmpdir/git/src" "$modulesdir/DirColors/1.1.2"
fi
