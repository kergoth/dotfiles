[ui]
ignore = ~/.config/hg/exclude
username = Christopher Larson <kergoth@gmail.com>
commitsubrepos = False

[merge-tools]
vimdiff.executable = vim
vimdiff.args = -f -d -c "wincmd J" "$output" "$local" "$base" "$other"

[extdiff]
cmd.opendiff = opendiff-w
cmd.wdiff = cwdiff
opts.wdiff = --diff --ab

[color]
status.modified = magenta bold
status.added = green bold
status.removed = red bold
status.deleted = cyan bold
status.unknown = blue
status.ignored = yellow

[extensions]
color =
pager =
progress =
bookmarks =
rebase =

extdiff =
gpg =
# Note: log supports -G without graphlog extension in mercurial 2.3+
graphlog =
histedit =
patchbomb =
purge =
record =
schemes =

crecord = ~/.config/hg/extensions/crecord/crecord
prompt = ~/.config/hg/extensions/prompt/prompt.py
shelve = ~/.config/hg/extensions/shelve/hgshelve.py
evolve = ~/.config/hg/extensions/evolve/hgext/evolve.py

[mq]
secret = True

[progress]
delay = 1.0

[schemes]
bbs = ssh://hg@bitbucket.org/
bbsk = ssh://hg@bitbucket.org/kergoth/
bbk = https://bitbucket.org/kergoth/
gh = git://github.com/
ghk = git://github.com/kergoth/
ghs = git+ssh://git@github.com/
ghsk = git+ssh://git@github.com/kergoth/

[auth]
bb.prefix = https://bitbucket.org/
bb.username = kergoth

[diff]
git = True
unified = 5

[email]
method = smtp
from = Christopher Larson <kergoth@gmail.com>

[smtp]
host = smtp.gmail.com
port = 587
username = kergoth@gmail.com
tls = True

[bookmarks]
track.current = True

[defaults]
rebase = --keepbranches
addremove = --similarity 100

[pager]
pager = diff-so-fancy | LESS=FRSXQ less
quiet = True
attend = diff,status,log,qdiff,blame,annotate,pdiff,glog,show,help,export

[hostfingerprints]
bitbucket.org = 46:de:34:e7:9b:18:cd:7f:ae:fd:8b:e3:bc:f4:1a:5e:38:d7:ac:24

[alias]
# Some useful little aliases.
st = status -SC
blame = annotate -nul
untrack = rm -Af

# Nudge: just push the current branch.
nudge = push --branch .

# Graph log
lg = log -G --template='\033[0;33m{rev}\033[0m {desc|firstline|strip} \033[0;35m{branches}\033[0m \033[0;33m{tags}\033[0m\n\033[1;30m({date|age} by {author|person})\033[0m\n\n' --pager=on

# Short log
slog = log --template '{rev}:{node|short} {desc|firstline}\n' --pager=on

# Show a single changeset
show = log --patch --verbose --rev

# Ala git describe
describe = log --template '{latesttag}-{latesttagdistance}-{node|short}\n' --rev

# Show mq status
qstatus = status --rev -2:.

# Edit the current repo's hgrc file.
erc = config --local

# Merge, dropping changes from the other branch
merge-ours = !"$HG" -y merge --tool=internal:fail "$@" && "$HG" revert --all --rev . && "$HG" resolve -a -m

# Simple bug/todo tracking
# Idea from Justin: http://gist.github.com/464871
# Install t first: http://bitbucket.org/sjl/t/
bug = !t.py --task-dir="`$HG root`" --list=BUGS $@
todo = !t.py --task-dir="`$HG root`" --list=TODO $@

# Run hg commands on all subrepos at once.
subs = !"$HG" debugsub | sed -n 's/^path //p; s/ /\ /g' | xargs          -I SUB $HG -R "`$HG root`/SUB" $@
psubs = !"$HG" debugsub | sed -n 's/^path //p; s/ /\ /g' | parallel -j10 -I SUB $HG -R "`$HG root`/SUB" $@

# Run shell commands on all subrepos at once.
subscmd = !"$HG" debugsub | sed -n 's/^path //p; s/ /\ /g' | xargs          -I SUB sh -c "cd \"`$HG root`/SUB\" && $@"
psubscmd = !"$HG" debugsub | sed -n 's/^path //p; s/ /\ /g' | parallel -j10 -I SUB sh -c "cd \"`$HG root`/SUB\" && $@"

update-git-subs = subscmd 'test -e .git && git fetch && git checkout remotes/origin/master'
update-hg-subs = subscmd 'test -e .hg && hg pull && hg update tip'
update-subs = !"$HG" update-hg-subs; "$HG" update-git-subs

# Local settings
%include ~/.config/hg/$HOST.rc
%include ~/.hgrc_local
