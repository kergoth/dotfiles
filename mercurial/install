if which hg >/dev/null 2>&1; then
    newest_version () {
        for ver; do
            printf "$ver\n"
        done | sort -t. -n | tail -n 1
    }

    hg_version=$(hg --version 2>/dev/null | sed -n 's/.*(version \([0-9.]*\))$/\1/p')
    if [ "$(newest_version 2.3 $hg_version)" = 2.3 ]; then
        sed 's/histedit =/histedit = ~/.config/hg/extensions/hg_histedit.py' hgrc > hgrc.new && mv hgrc.new hgrc
    fi

    link hgrc.redir ~/.hgrc
    link . ~/.config/hg
fi
