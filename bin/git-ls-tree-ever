#!/bin/sh

commit=$1
shift
tree=$1
shift

git rev-list "$commit" -- "$tree" | while read rev; do
    if [ -z "$tree" ]; then
        git ls-tree "${rev}"
    else
        git ls-tree "${rev}:$tree"
    fi
done | awk '{print $1 " " $2 " " $4}' | sort -u

# git rev-list "$commit" | xargs -n 1 git ls-tree | sort -u
