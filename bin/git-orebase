#!/bin/bash
# Rebase the current branch against the branch it's tracking
# vim: set et fenc=utf-8 sts=4 sw=4 :

branch=$(git symbolic-ref HEAD)
if [ $? -ne 0 ]; then
    echo >&2 "Unable to operate against a floating HEAD"
    exit 1
fi
branch=$(basename $branch)
remote=$(git config branch.$branch.remote)
merge=$(git config branch.$branch.merge)
if [ -z "$remote" -o -z "$merge" ]; then
    echo >&2 "This branch does not currently track another branch.  Please set branch.<branch>.{remote,merge}."
    exit 1
fi
exec git rebase "$@" "$remote/$merge"
