if which bat >/dev/null 2>&1; then
    cfgpath=$(bat --config-dir)
else
    cfgpath=$XDG_CONFIG_HOME/bat
fi
mkdir -p $cfgpath

if [ -e $cfgpath/syntax ] && [ ! -e $cfgpath/syntaxes ]; then
    mv $cfgpath/syntax $cfgpath/syntaxes
fi

if [ -h $cfgpath ]; then
    rm -f $cfgpath
fi

mkdir -p $cfgpath/syntaxes
find $PWD/syntaxes/ -name \*.sublime-syntax | xargs -I"{}" ln -sf "{}" $cfgpath/syntaxes/

mkdir -p $cfgpath/themes
find $PWD/themes/ -name \*.tmTheme | xargs -I"{}" ln -sf "{}" $cfgpath/themes/

#if [ ! -e $cfgpath/syntaxes/Packages ]; then
#    git clone https://github.com/sublimehq/Packages $cfgpath/syntaxes/Packages
#fi

if [ ! -e $cfgpath/syntaxes/Elixir ]; then
    git clone https://github.com/princemaple/elixir-sublime-syntax $cfgpath/syntaxes/Elixir
fi

if which bat >/dev/null 2>&1; then
    bat cache --build
fi

link bat.conf $XDG_CONFIG_HOME/bat/config
