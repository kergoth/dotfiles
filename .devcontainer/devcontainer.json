{
  "name": "Dotfiles",
  "build": {
    "dockerfile": "./Dockerfile"
  },
  "features": {
    "ghcr.io/rio/features/chezmoi:1": {},
    "ghcr.io/devcontainers/features/common-utils:2": {},
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {},
    "ghcr.io/devcontainers/features/nix:1": {}
  },

  // Tell VS Code / devcontainers what path to use as the workspace
  "workspaceFolder": "/home/vscode/dotfiles",

  // Override the default mount so the host folder is bound there
  "workspaceMount": "source=${localWorkspaceFolder},target=/home/vscode/dotfiles,type=bind",

  "containerEnv": {
    // Inside the container this is now the path you care about:
    "WORKSPACE_PATH": "/home/vscode/dotfiles",
    "WORKSPACE_NAME": "dotfiles",
    "GITHUB_TOKEN": "${localEnv:GITHUB_TOKEN}"
  },

  "mounts": [
    "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind",
    "source=devcontainer-bashhistory,target=/commandhistory,type=volume",
    "target=/home/vscode/.vscode-server,type=volume"
  ],

  "postCreateCommand": "./script/setup",
  "remoteUser": "vscode"
}
