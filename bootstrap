#!/bin/sh

set -e

dotfiles=$1
if [ -z "$dotfiles" ]; then
    dotfiles=~/.dotfiles
fi

if [ ! -e $dotfiles ]; then
    git clone git://github.com/kergoth/homefiles $dotfiles
fi
cd $dotfiles
git submodule init
git submodule update

while read dest url; do
    if [ ! -e $dotfiles/$dest ]; then
        hg clone $url $dotfiles/$dest
    fi
done<<END
hgext/crecord https://bitbucket.org/edgimar/crecord
hgext/histedit https://bitbucket.org/durin42/histedit
hgext/pbranch https://bitbucket.org/parren/hg-pbranch
hgext/prompt https://bitbucket.org/sjl/hg-prompt
hgext/shelve https://bitbucket.org/tksoh/hgshelve
END

if [ ! -e $dotfiles/vim/bundle/vundle ]; then
    git clone git://github.com/gmarik/vundle.git $dotfiles/vim/bundle/vundle
fi

~/.dotfiles/bin/dotfiles-install
